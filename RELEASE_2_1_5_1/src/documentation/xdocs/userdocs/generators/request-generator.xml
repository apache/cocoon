<?xml version="1.0" encoding="UTF-8"?>
<!--
  Copyright 1999-2004 The Apache Software Foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!DOCTYPE document PUBLIC "-//APACHE//DTD Documentation V1.0//EN" "document-v10.dtd">

<document>
    <header>
        <title>Request Generator</title>
        <version>0.9</version>
        <type>Technical document</type>
        <authors>
            <person name="Carsten Ziegeler" email="cziegeler@apache.org"/>
         </authors>
         <abstract>This document describes the request generator of Cocoon.</abstract>
    </header>
    <body>
        <s1 title="Request Generator">
            <p>The request generator uses the current request to produce xml data.
                     It converts some of the information contained in the request
                     to structured xml.</p>
            <ul>
                <li>Name : request</li>
                <li>Class: org.apache.cocoon.generation.RequestGenerator</li>
                <li>Cacheable: no.</li>
            </ul>
<source><![CDATA[
<map:generate type="request"/>
<!-- The src attribute is optional -->
]]></source>
            <p>The output has the following schema. All elements have the namespace
               <code>http://apache.org/cocoon/request/2.0</code></p>

<source><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>

<!-- The root element is request. The target attribute is the 
     requested uri and the source attribute is the optional 
     source attribute of the sitemap entry for this pipeline. -->
<request target="/cocoon/request" source=""
         xmlns="http://apache.org/cocoon/request/2.0">

  <!-- First the headers: -->
  <requestHeaders>
    <header name="accept-language">de</header>
    <header name="connection">Keep-Alive</header>
    <header name="accept">image/gif, image/x-xbitmap, image/jpeg,
      image/pjpeg, */*</header>
    <header name="host">thehost.serving.cocoon</header>
    <header name="accept-encoding">gzip, deflate</header>
    <header name="user-agent">Browser User Agent</header>
    <header name="referer">http://thehost.serving.cocoon/cocoon/welcome
      </header>
  </requestHeaders>

  <!-- All request parameters: -->
  <requestParameters>
    <!-- Create a parameter element for each parameter -->
    <parameter name="login">
      <!-- Create a value element for each value -->
      <value>test</value>
    </parameter>
  </requestParameters>

  <!-- All request attributes; see below the note on generate-attributes parameter. 
       (This feature is available startign with version 2.1 -->
  <requestAttributes>
    <!-- Create an attribute element for each attribute -->
    <attribute name="errorMessage">
      <!-- Create a value element for the attribute value -->
      <value>I was put here by an earlier action.</value>
    </attribute>
  </requestAttributes>

  <!-- All configuration parameters: -->
  <configurationParameters>
    <!-- Create a parameter element for each parameter specified 
         in the pipeline for this generator-->
    <parameter name="test_sitemap_parameter">the value</parameter>
  </configurationParameters>

</request>
]]></source>


            <note>If you want request attributes to be generated, you must specify <code>generate-attributes</code> parameter at generator definition or invocation in the sitemap.</note>
<source><![CDATA[
<!-- This will turn on attribute generation on by default -->
<map:generator name="request" src="org.apache.cocoon.generation.RequestGenerator"> 
    <map:parameter name="generate-attributes" value="true"/>
</map:generator>

<!-- or -->

    <!-- This will turn on attribute generation for this invocation only. -->
    <map:match pattern="request">
        <map:generate type="request">
	    <map:parameter name="generate-attributes" value="true"/>
        </map:generate>
    </map:match>


]]></source>
        </s1>
    </body>
</document>





