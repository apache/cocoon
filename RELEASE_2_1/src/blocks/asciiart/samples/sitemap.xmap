<?xml version="1.0"?>

<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

 <map:components>

  <map:generators default="file">
   <map:generator name="asciiart-svg" logger="sitemap.generator.asciiart-svg" 
                  src="org.apache.cocoon.generation.asciiart.AsciiArtSVGGenerator"/>
  </map:generators>

 </map:components>

<!-- =========================== Pipelines ================================= -->

 <map:pipelines>

  <map:pipeline>   
 
   <map:match pattern="">
    <map:redirect-to uri="welcome"/>
   </map:match>

   <map:match pattern="welcome">
     <map:generate type="directory" src="data">
       <map:parameter name="include" value="\.txt$"/>
     </map:generate>
     <map:transform src="dir2html.xsl"/>
     <map:serialize/>
   </map:match>

   <!-- expects format xxxyyyzzt.txt.png -->
   <map:match pattern="*.jpg">
     <map:generate type="asciiart-svg" src="data/{1}">
     </map:generate>
    <map:serialize type="svg2jpeg"/>
   </map:match>

   <!-- expects format xxxyyyzzt.txt.png -->
   <map:match pattern="*.png">
     <map:generate type="asciiart-svg" src="data/{1}">
     </map:generate>
    <map:serialize type="svg2png"/>
   </map:match>

   <map:match pattern="*.txt">
     <map:read src="data/{1}.txt"
       mime-type="text/plain"/>
   </map:match>

  </map:pipeline>
 </map:pipelines>

</map:sitemap>

