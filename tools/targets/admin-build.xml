<?xml version="1.0"?>
<project name="admin">
  
  <description>
    Admin targets
  </description>
  
  <!-- Creates the web site  -->
  <target name="site" depends="forrest, javadocs" description="[admin] Builds the site">
    <mkdir dir="${site}"/>
    <copy todir="${site}" filtering="off">
      <fileset dir="${build.site}"/>
    </copy>
    <copy todir="${site}/apidocs" filtering="off">
      <fileset dir="${build.javadocs}"/>
    </copy>
  </target>

  <!-- Create the announcements -->
  <target name="announcement" depends="prepare-docs">
    <copy file="announcement.xml" tofile="${build.context}/xdocs/announcement.xml" filtering="on"/>
    <xslt in="${build.context}/xdocs/announcement.xml"
          out="${build}/announcement.txt"
          style="${build.context}/stylesheets/announcement2txt.xsl"
          force="true"/>
  </target>

  <target name="generate-blocks.properties" depends="init">
    <xslt in="gump.xml"
          out="blocks.properties"
          style="${tools.src}/gump2blocks.properties.xsl"
          force="true"/>
  </target>

<!-- === Gump Targets ====================================================== -->

  <!-- compiles and packages the core classes and the deprecated classes -->
  <target name="gump-core" depends="package-core, package-deprecated, javadocs, validate-jars, junit-tests"/>

  <!-- compiles and packages a single block identified by ${block-name} -->
  <target name="gump-block" depends="compile-core, compile-deprecated, prepare-blocks, compile-tests">
    <ant antfile="${build.temp}/blocks-build.xml"
         inheritAll="true"
         inheritRefs="false"
         target="cocoon-block-${block-name}-tests"/>
  </target>
</project>