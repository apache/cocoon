<?xml version="1.0"?>

<!DOCTYPE document SYSTEM "../dtd/document-v10.dtd">

<document>
 <header>
  <title>Installing Cocoon</title>
  <authors>
   <person name="Stefano Mazzocchi" email="stefano@apache.org"/>
   <person name="Brett McLaughlin" email="bmclaugh@algx.net"/>
  </authors>
 </header>
 
 <body>
 
 <s1 title="System Requirements">
  <p>
   Cocoon requires the following systems to be already installed in your
   system:
  </p>
  
  <ul>
   <li><strong>Java Virtual Machine</strong>
    A Java 1.1 or greater compatible virtual machine must be present for both
    command line and servlet type usage of Cocoon. Note that all servlet engines
    require a JVM to run so if you are already using servlets you already have
    one installed.
   </li>
   <li><strong>Servlet Engine</strong>
    A Servlet 2.x compliant servlet engine  must be present in order to support 
    servlet operation and dynamic request handling. Note that this requirement
    is optional for command line operation.
   </li>
  </ul>
 </s1>
 
 <s1 title="Required Components">
  <p>
   Cocoon is a publishing framework and was designed to be highly modular to
   allow users to choose their preferred implementation for the required
   component and to allow better and faster parallel development.
  </p>
  
  <p>
   Here is a list of supported components with their minimum version required
   to operate with this version of Cocoon:
  </p>
  
  <table>
   <caption>XML Parsers</caption>
   <thead>
    <tr>
     <th>Name</th>
     <th>Version</th>
     <th>Location</th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td><strong>Apache Xerces</strong></td>
     <td>1.0 (java edition)</td>
     <td><link href="http://xml.apache.org/dist/">xml.apache.org</link></td>
    </tr>
    <tr>
     <td>Sun ProjectX</td>
     <td>TR2</td>
     <td><link href="http://java.sun.com/xml/">java.sun.com</link></td>
    </tr>
    <tr>
     <td>OpenXML</td>
     <td>1.1build5</td>
     <td><link href="http://www.openxml.org/">www.openxml.org</link></td>
    </tr>
   </tbody>
   <tfoot>
    <tr>
     <td colspan="3">Cocoon comes preconfigured for Xerces</td>
    </tr>
   </tfoot>
  </table>
   
  <table>
   <caption>XSLT Processor</caption>
   <thead>
    <tr>
     <th>Name</th>
     <th>Minimum Version</th>
     <th>Location</th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>Apache Xalan</td>
     <td>0.19.1</td>
     <td><link href="http://xml.apache.org/dist/">xml.apache.org</link></td>
    </tr>
    <tr>
     <td>James Clark's XT</td>
     <td>19991102</td>
     <td><link href="http://www.jclark.com/">www.jclark.com</link></td>
    </tr>
    <tr>
     <td>Keith Visco's XSL:P</td>
     <td>19991111</td>
     <td><link href="http://xslp.kvisco.com/">xslp.kvisco.com</link></td>
    </tr>
   </tbody>
   <tfoot>
    <tr>
     <td colspan="3">Cocoon comes preconfigured for Xalan</td>
    </tr>
   </tfoot>
  </table>   
   
  <table>
   <caption>Other Required Components</caption>
   <thead>
    <tr>
     <th>Name</th>
     <th>Minimum Version</th>
     <th>Location</th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>Apache FOP</td>
     <td>0.12.0</td>
     <td><link href="http://xml.apache.org/dist/">xml.apache.org</link></td>
    </tr>
    <tr>
     <td>GNU Regexp</td>
     <td>1.0.8</td>
     <td><link href="http://www.cacas.org/java/gnu/regexp/">www.cacas.org/java/gnu/regexp</link></td>
    </tr>
   </tbody>
  </table>   
  
  <note>
   Cocoon is strictly dependent on some printing classes contained into Xerces
   so, even if you use another parser, you should still keep Xerces visible
   to Cocoon.
  </note>
  
  <p>
   Being an Apache project, Cocoon focuses on Apache technologies but we are
   dedicated to support all compatible XML/XSL technologies and will welcome
   contributions to add support for other components not currently supported.
  </p>
  
  <p>
   So this is your shopping list for components for complete operation:
  </p>
   
   <ul>
    <li>Apache Xerces (required for the formatting classes)</li>
    <li>Your favorite XML parser</li>
    <li>Your favorite XSLT processor</li>
    <li>Apache FOP (optional, unless you want PDF rendering)</li>
    <li>GNU Regexp (optional, unless you use <em>ProducerFromMap</em>)</li>
   </ul>
   
  <p>
   All right. Now that you have downloaded all the components you need, go on
   and jump to the installation instructions for your servlet engine.
  </p>
 </s1>
 
 <s1 title="Installing Cocoon">
  <p>
   Being Cocoon a servlet, you should be able to install it on every compliant
   servlet engine by associating the "org.apache.cocoon.Cocoon" servlet
   with the requests you want it to handle. In order to do this, there is no
   standard way, so we try to provide detailed information for the most used
   servlet systems.
  </p>
  
  <s2 title="Installing Cocoon on Apache JServ">
   <p>
    Apache JServ has one configuration file for the whole engine (normally called
    <code>jserv.properties</code>) and one for each servlet zone. Please, refer
    to the Apache JServ documentation for more information on this.
   </p>
   
   <p>
    First thing to do is to make sure that Cocoon and all the needed components
    (as explained in the previous section) are visible. This implies adding 
    this to the servlet engine classpath by adding a line like this in your 
    <code>jserv.properties</code> file for each jar package you have to install
    (after substituting <em>[path-to-jar]</em> with the path to the jar file and
    <em>[jar-name]</em> with the package file name).
   </p>
    
   <source>wrapper.classpath=[path-to-jar]/[jar-name].jar</source>
   
   <p>
    Here is an example:
   </p>
   
<source>
wrapper.classpath=/usr/local/java/lib/cocoon.jar
wrapper.classpath=/usr/local/java/lib/xerces.jar
wrapper.classpath=/usr/local/java/lib/xalan.jar
wrapper.classpath=/usr/local/java/lib/fop.jar
wrapper.classpath=/usr/local/java/lib/regexp.jar
</source>
   
   <note>
    from this version of Cocoon the <code>Cocoon.jar</code> 
    package should be added to the servlet engine classpath as any other
    required package (as shown above).
   </note>
   
   <p>
    At this point, you must set the Cocoon configurations. To do this, you 
    must choose the servlet zone(s) where you want Cocoon to reside (Note that
    Cocoon can safely reside on different servlet zones with different
    configuration files). If you don't know what a servlet zone is, you 
    probably want to open the <code>zone.properties</code> file that represents 
    the default servlet zone.
   </p>
   
   <p>
    To configure Cocoon, you must pass the <code>cocoon.properties</code>
    file location to the servlet by adding the following to the 
    <code>zone.properties</code> file (or each servlet zone file you want
    Cocoon to reside):
   </p>
   
   <source>servlet.org.apache.cocoon.Cocoon.initArgs=properties=[path-to-cocoon]/bin/cocoon.properties</source>
  
   <p>
    Note that you should not need to change anything from the template
    properties file found in the distribution, but you must edit it for 
    more complex operation. Please refer directly to the file that contains
    breaf indications and comments on the different configurations, but you
    don't need to care about that at this point.
   </p>
   
   <p>
    Now your cocoon servlet is properly configured, but you should tell Apache
    to direct any call to an XML file (or any other file you want Cocoon to
    process) to the Cocoon servlet. To do this, you should add the following line
    to your <code>mod_jserv.conf</code> or <code>jserv.conf</code> file:
   </p>
    
   <source>ApJServAction .xml /servlet/org.apache.cocoon.Cocoon</source>
  
   <p>
    where <em>.xml</em> is the file extention you want to map to the servlet
    and <em>/servlet/</em> is the mount point of your servlet zone (and the
    above is the standard name for servlet mapping for Apache JServ).
   </p>
   
   <p>
    Everything should be configured fine. Restart both Apache and Apache JServ
    and try accessing the samples contained in the distribution to see
    Cocoon in action.
   </p>
   
   <p>
    <strong>Note</strong>: you may want Cocoon to handle two different 
    extentions with different configurations. To do this, you must set the two 
    different configurations in two different servlet zones, then associate the 
    extentions like this:
   </p>
   
<source>ApJServAction .xml1 /zone1/org.apache.cocoon.Cocoon
ApJServAction .xml2 /zone2/org.apache.cocoon.Cocoon</source>           

   <p>
    where <em>.xml1</em> is handled by the Cocoon residing on <em>zone1</em>
    and <em>.xml2</em> is handled by the Cocoon residing on <em>zone2</em>
    which have different configurations and thus different behavior.
   </p>
  </s2>
  
  <s2 title="Installing Cocoon on Apache Tomcat">
    <p>
     Tomcat has two basic methods of locating Java classes for the runtime environment.
     The first is the overall classpath that Tomcat uses to run, and this is the
     classpath provided to Java classes that use constructs such as
     <code>Class.forName().newInstance()</code>.  The second classpath is
     associated with a specific context, and is somewhat analagous to the
     servlet zones used in Apache JServ (see section above).
    </p>

    <p>
     Because the Cocoon framework utilizes <code>Class.forName()</code> and other
     dynamic instance handling techniques, the Cocoon classes need to have its
     classpath aware of the component classes used within the framework.  To do 
     this, take all the required components (see above) and put them in your 
     <em>&lt;Tomcat-Root&gt;/lib</em> directory.  This is the standard location 
     for Tomcat core libraries. To ensure that Tomcat will use these, you need 
     to edit the Tomcat startup file.
    </p>
    
    <p>
     On Windows, this is <em>&lt;Tomcat-Root&gt;/tomcat.bat</em> and on
     Unix, this is <em>&lt;Tomcat-Root&gt;/tomcat.sh</em>.  In this 
     file you must add all the component jar files to Tomcat's classpath.
    </p>

    <note>
     from this version of Cocoon the <code>Cocoon.jar</code> 
     package should be added to the servlet engine classpath as any other
     required package (as shown above).
    </note>
   
    <p>
     Next you need to tell your context where Cocoon can find it's properties 
     file, as well as to map Cocoon to XML document requests.
     Make sure you have a <em>web.xml</em> file in your context's
     <em>WEB-INF</em> directory.  This file specifies servlet mappings
     and initial arguments to servlets.  If you don't have this file, you can copy
     an example from <em>&lt;Tomcat-Root&gt;/examples/WEB-INF</em>
     directory.  You should add the following entries in that file:
    </p>

<source><![CDATA[
 <servlet>
  <servlet-name>org.apache.cocoon.Cocoon</servlet-name>
  <servlet-class>org.apache.cocoon.Cocoon</servlet-class>
  <init-param>
   <param-name>properties</param-name>
   <param-value>
     [path-to-cocoon.properties]/cocoon.properties
   </param-value>
  </init-param>
 </servlet>
 
 <servlet-mapping>
  <servlet-name>org.apache.cocoon.Cocoon</servlet-name>
  <url-pattern>*.xml</url-pattern>
 </servlet-mapping>
]]></source>

    <p>
     Make sure you replaced the path to the Cocoon.properties file with the 
     actual location of that file on your system.
     Note that you should not need to change anything from the template
     properties file found in the distribution, but you must edit it for
     more complex operation. Please refer directly to the file that contains
     brief indications and comments on the different configurations, but you
     don't need to care about that at this point.
    </p>

    <p>
     Everything should be configured fine. Restart Tomcat
     and try accessing the samples contained in the distribution to see
     Cocoon in action.
    </p>   
  </s2>
  
  <s2 title="Installing Cocoon on Allaire JRun">
   <p>Yet to be written! <em>Volunteers welcome!</em></p>
  </s2>
  
  <s2 title="Installing Cocoon on NewAtlanta ServletExec">
   <p>Yet to be written! <em>Volunteers welcome!</em></p>
  </s2>  

 </s1>
 
 <s1 title="Working Systems">
  <p>
   Cocoon has been reported to be working on these systems:
  </p>
  
  <ul>
    <li>RedHat Linux 6.0 + Apache 1.3.9 + Apache JServ 1.0 + IBM JDK 1.1.8</li>
    <li>RedHat Linux 6.0 + Apache 1.3.9 + Apache JServ 1.1b3 + IBM JDK 1.1.8</li>
    <li>RedHat Linux 6.0 + Apache 1.3.9 + Apache JServ 1.0 + Blackdown JDK 1.2pre2</li>    
    <li>RedHat Linux 6.1 + Apache 1.3.9 + JRun 2.3.3 + IBM JRE 1.1.8</li>
    <li>Windows 98 + Apache 1.3.9 + Apache JServ 1.0 + IBM JDK 1.1.7</li>
    <li>Windows 98 + Apache 1.3.9 + Apache JServ 1.1b3 + IBM JDK 1.1.7</li>
    <li>Windows 98 + Apache 1.3.9 + Apache JServ 1.0 + Sun JDK 1.2.2</li>
    <li>Windows 98 + Apache 1.3.9 + Apache JServ 1.1b3 + Sun JDK 1.2.2</li>
    <li>Windows 98 + MS Personal Web Server + ServletExec 2.2 + Sun JDK 1.2.1</li>
    <li>Windows NT 4.0 + IIS 4.0 + ServletExec 2.2 + Sun JDK 1.2.1</li>
    <li>Windows NT 4.0 + IIS 4.0 + JRun 2.3.3 + Sun JDK 1.2.1</li>
    <li>Windows NT 4.0 + Apache 1.3.9 + JRun 2.3.3 + Sun JDK 1.2.2</li>
    <li>MacOS 8.6 + WebSTAR 4.0 + JRun 2.3 + MrJ 2.1.4</li>
    <li>MacOS 8.6 + WebSTAR 4.0 + ServletExec 2.1 + Mrj 2.1.4</li>
    <li>SunOS Netria 5.6 + Apache 1.3.9 + Apache JServ 1.1b3 + Sun JDK 1.1.7</li>
    <li>SCO OpenServer 5 + WebLogic 4.5.1 + SCO JDK 1.1.7A</li>
  </ul>
  
  <p>
   <em>Note:</em> due to a bug in <link href="http://www.blackdown.org">Blackdown
   JDK 1.2pre2</link> for Linux, we suggest you to use green threads instead of the
   native ones which are much less stable, expecially highly concurrent operations
   like servlet engines and servlet execution.
  </p>
  <p>
   Please, submit your feedback if you were able to install Cocoon on a
   different combination not listed above. Thanks.
  </p>
 </s1>
</body></document>