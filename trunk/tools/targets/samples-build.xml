<?xml version="1.0"?>
<project name="samples">

  <description>
    Samples Targets
  </description>

  <target name="samples" depends="prepare" unless="unless.exclude.webapp.samples">
    <mkdir dir="${build.samples}"/>

    <javac srcdir="${samples}"
       destdir="${build.samples}"
       debug="${compiler.debug}"
       optimize="${compiler.optimize}"
       deprecation="${compiler.deprecation}"
       target="${target.vm}"
       compiler="${compiler}"
       classpathref="classpath"/>

    <!-- copy sample files -->
    <copy todir="${build.webapp.samples}" filtering="on">
      <fileset dir="${webapp.samples}">
       <exclude name="samples.xwelcome"/>
       <exclude name="old_sitemap.xmap"/>
       <exclude name="**/*.jpg"/>
       <exclude name="**/*.gif"/>
       <exclude name="**/*.png"/>
       <exclude name="i18n/**"/> <!-- filtering breaks UTF-8 files -->
       <exclude name="hello-world/style/xsl/**"/> <!-- filtering breaks UTF-8 files -->
      </fileset>
    </copy>

    <copy todir="${build.webapp.samples}" filtering="off">
      <fileset dir="${webapp.samples}">
       <include name="**/*.jpg"/>
       <include name="**/*.gif"/>
       <include name="**/*.png"/>
       <include name="i18n/**"/>
       <include name="hello-world/style/xsl/**"/>
      </fileset>
    </copy>

    <!-- copy sample classes -->
    <copy todir="${build.webapp.classes}" filtering="off">
      <fileset dir="${build.samples}"/>
    </copy>

    <!-- patch the welcome page to tell we have samples to show -->
    <xpatch file="${build.webapp}/welcome.xml"
            srcdir="${webapp.samples}" 
            includes="**/*.xwelcome"/>
  </target>
</project>
  
