<?xml version="1.0"?>

<!-- jfor block samples sitemap -->

<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

<!-- =========================== Components ================================ -->

 <map:components>

<!-- =========================== Generators ================================= -->

  <map:generators default="file">

   <map:generator label="content,data" logger="sitemap.generator.file" name="file"
                  src="org.apache.cocoon.generation.FileGenerator"/>

  </map:generators>

<!-- =========================== Transformers ================================= -->

  <map:transformers default="xslt">
   <map:transformer name="xslt" src="org.apache.cocoon.transformation.TraxTransformer"
                    logger="sitemap.transformer.xsltc">
    <use-request-parameters>true</use-request-parameters>
    <use-browser-capabilities-db>false</use-browser-capabilities-db>
    <transformer-factory>org.apache.xalan.xsltc.trax.TransformerFactoryImpl</transformer-factory>
   </map:transformer>

   </map:transformers>

<!-- =========================== Serializers ================================= -->

  <map:serializers default="html">
   <map:serializer 
   			name="fo2rtf" src="org.apache.cocoon.serialization.RTFSerializer"
            logger="sitemap.serializer.rtf">
   </map:serializer>
   
   <map:serializer logger="sitemap.serializer.xml" mime-type="text/xml" name="xml"
                   src="org.apache.cocoon.serialization.XMLSerializer">
    <indent>yes</indent>
   </map:serializer>

   <map:serializer logger="sitemap.serializer.html" mime-type="text/html" name="html" 
                   src="org.apache.cocoon.serialization.HTMLSerializer">
    <buffer-size>1024</buffer-size>
   </map:serializer>

   <map:serializer logger="sitemap.serializer.links" name="links"
                   src="org.apache.cocoon.serialization.LinkSerializer"/>

  </map:serializers>

<!-- =========================== Readers ================================= -->

  <map:readers default="resource">
   <map:reader logger="sitemap.reader.resource" name="resource" 
                src="org.apache.cocoon.reading.ResourceReader"/>
  </map:readers>

<!-- =========================== Matchers ================================= -->

  <map:matchers default="wildcard">
   <map:matcher logger="sitemap.matcher.wildcard" name="wildcard"
                src="org.apache.cocoon.matching.WildcardURIMatcher"/>
  </map:matchers>

<!-- ====================== Pipelines defintions ============================= -->

  <map:pipes default="caching">
   <map:pipe name="caching"    src="org.apache.cocoon.components.pipeline.impl.CachingProcessingPipeline"/>
   <map:pipe name="noncaching" src="org.apache.cocoon.components.pipeline.impl.NonCachingProcessingPipeline"/>
   
  </map:pipes>

 </map:components>

<!-- =========================== Views =================================== -->

 <map:views>
  <map:view from-label="content" name="content">
   <map:serialize type="xml"/>
  </map:view>

  <map:view from-position="last" name="links">
   <map:serialize type="links"/>
  </map:view>

 </map:views>

<!-- =========================== Pipelines ================================= -->

 <map:pipelines>

  <map:pipeline type="caching">  
   <map:match pattern="">
    <map:redirect-to uri="welcome"/>
   </map:match>
   
   <map:match pattern="welcome">
    <map:generate src="misc/samples.xml"/>
    <map:transform src="context://samples/common/style/xsl/html/simple-samples2html.xsl">
       <map:parameter name="contextPath" value="{request:contextPath}"/>
    </map:transform>
    <map:serialize/>
   </map:match>

   <!-- ========================= jfor ================================ -->

   <map:match pattern="*.fo.xml">
    <map:generate src="misc/{1}.fo.xml"/>
    <map:serialize type="xml"/>
   </map:match>

   <map:match pattern="*.rtf">
    <map:generate src="cocoon:/{1}.fo.xml"/>
    <map:serialize type="fo2rtf"/>
   </map:match>

   <map:match pattern="*.css">
    <map:read src="misc/{1}.css"/>
   </map:match>

   <map:match pattern="**/*.css">
    <map:read src="misc/{2}.css"/>
   </map:match>

  </map:pipeline>

 </map:pipelines>

</map:sitemap>
