<?xml version="1.0"?>
<!-- Example binding to bind the "form2" form to the bean "Form2Bean" -->

<!-- The id attributes on the elements in this file map to widgets in the
     form definition. The path attributes are JXPath expressions addressing
     properties of the bean. -->

<!-- It would be an interesting exercise to generate this file from
     javadoc-tags in the bean using an xdoclet-like approach. -->

<wb:context xmlns:wb="http://apache.org/cocoon/woody/binding/1.0" path="/" >

  <!-- the email value will not be saved because of the @readonly -->
  <wb:field id="email" path="email" readonly="true"/>
  <wb:field id="ipaddress" path="ipAddress"/>
  <wb:field id="birthday" path="birthday"/>
  <wb:field id="number" path="aNumber"/>

  <!-- An aggregatefield is a special kind of widget that lets
  the user edit the value of multiple widgets through one text box
  (see also the form definition for how this works). In this case
  it is used to map the different parts of a phone number to different
  bean properties. -->
  <wb:aggregate id="phone" path="." >
    <wb:field id="number" path="phoneNumber"/>
    <wb:field id="zone"   path="phoneZone"/>
    <wb:field id="cntr"   path="phoneCountry"/>
  </wb:aggregate>

  <!-- repeater requires unique identification mechanism of the row-nodes -->
  <!-- (it is of course possible to implement other binding strategies) -->
  <wb:repeater id="contacts"
    parent-path="."
    row-path="contacts"
    unique-row-id="id"
    unique-path="@id">

    <!-- important note: the row-path is used inside jxpath-createPath context,
    as a consequence it cannot have dependent children or predicates -->

    <wb:on-bind>
      <!-- executed on updates AND right after the insert -->
      <wb:field id="firstname" path="firstName"/>
      <wb:field id="lastname" path="lastName"/>
      <wb:field id="phone" path="phone"/>
      <wb:field id="email" path="email"/>
    </wb:on-bind>

    <wb:on-delete-row>
      <wb:delete-node/>
    </wb:on-delete-row>

    <wb:on-insert-row>
      <wb:insert-bean
        classname="org.apache.cocoon.woody.samples.Contact"
        addmethod="addContact"/>
    </wb:on-insert-row>
  </wb:repeater>

</wb:context>
