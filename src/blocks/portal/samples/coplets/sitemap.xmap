<?xml version="1.0"?>

<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

<map:pipelines>
    
  <map:pipeline>	

    <!-- this is a gallery coplet -->
    <map:match pattern="gallery">
        <map:generate type="directory" src="{coplet:copletData/attributes/image-dir}">
            <map:parameter name="include" value="{coplet:copletData/attributes/image-include}"/>
        </map:generate>
        <map:transform src="gallery/dir2pic.xsl">
            <map:parameter name="dirprefix" value="{coplet:copletData/attributes/image-uri-prefix}"/>
        </map:transform>
        <map:transform type="xslt" src="gallery/picture.xsl">
          <map:parameter name="pic" value="{coplet:attributes/picture}"/>
          <map:parameter name="fullscreen" value="{coplet:aspectDatas/fullScreen}"/>
        </map:transform>
        <map:transform type="portal-coplet"/>
        <map:serialize type="xml"/>
    </map:match>
    <map:match pattern="galleryviewer">
        <map:generate type="directory" src="../../petstore/images">
            <map:parameter name="include" value=".jpg"/>
        </map:generate>
        <map:transform src="gallery/dir2pic.xsl">
            <map:parameter name="dirprefix" value="../petstore/images"/>
        </map:transform>
        <map:transform type="xslt" src="gallery/picture.xsl">
          <map:parameter name="pic" value="{coplet:attributes/picture}"/>
          <map:parameter name="fullscreen" value="{coplet:aspectDatas/fullScreen}"/>
          <map:parameter name="navigation" value="false"/>
        </map:transform>
        <map:transform type="portal-coplet"/>
        <map:serialize type="xml"/>
    </map:match>

  </map:pipeline>

</map:pipelines>
</map:sitemap>
