<?xml version="1.0"?>

<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

 <map:components>

      <map:transformers default="xalan">
        <map:transformer name="woody" src="org.apache.cocoon.woody.transformation.WoodyTemplateTransformer" logger="woody"/>
        <map:transformer name="i18n" src="org.apache.cocoon.transformation.I18nTransformer">
          <catalogues default="other">
            <catalogue id="other" name="OtherMessages" location="context://samples/woody/messages"/>
            <catalogue id="woody" name="WoodyMessages" location="context://samples/woody/messages"/>
          </catalogues>
          <cache-at-startup>true</cache-at-startup>
        </map:transformer>
      </map:transformers>

      <map:pipes default="caching">
      </map:pipes>

 </map:components>

 <map:views>
  <map:view name="content" from-label="content">
   <map:serialize type="xml"/>
  </map:view>

  <map:view from-label="content" name="pretty-content">
   <map:transform src="context://stylesheets/system/xml2html.xslt"/>
   <map:serialize type="html"/>
  </map:view>

  <map:view name="links" from-position="last">
   <map:serialize type="links"/>
  </map:view>
 </map:views>

  <!-- indicates what flowscript to attach to this sitemap -->
  <map:flow language="javascript">
	<map:script src="woody/employee.js"/>
  </map:flow>

 <map:pipelines>
   <map:pipeline>

     <map:match pattern="">
      <map:generate src="welcome.xml"/>
      <map:transform src="context://samples/common/style/xsl/html/simple-samples2html.xsl">
         <map:parameter name="contextPath" value="{request:contextPath}"/>
      </map:transform>
      <map:serialize/>
     </map:match>

     <map:match pattern="jdo/xspdemo">
        <map:generate src="jdo/xsp/demo1.xsp" type="serverpages"/>
        <map:transform src="context://samples/stylesheets/dynamic-page2html.xsl">
            <map:parameter name="servletPath" value="{request:servletPath}"/>
            <map:parameter name="sitemapURI" value="{request:sitemapURI}"/>
            <map:parameter name="contextPath" value="{request:contextPath}"/>
            <map:parameter name="file" value="jdo/xsp/xspdemo.xsp"/>
            <map:parameter name="remove" value="{0}"/>
        </map:transform>
        <map:serialize/>
     </map:match>

     <!--
        | "Form1" example, demonstrates usage of flow and woody
        -->

    <map:match pattern="jdo/woody/employee">
        <map:call function="woody">
            <map:parameter name="function" value="employeeform_jdo"/>
            <map:parameter name="form-definition" value="woody/employee.xml"/>
            <map:parameter name="bindingURI" value="woody/employee_bind.xml"/>            
        </map:call>
    </map:match>

    <map:match pattern="jdo/woody/employee-form-display">
        <map:generate src="woody/employee_template.xml"/>
        <map:transform type="woody"/>
        <map:transform type="i18n">
            <map:parameter name="locale" value="en-US"/>
        </map:transform>
        <map:transform src="context://samples/woody/xsl/html/woody-default.xsl"/>
        <map:transform src="context://samples/common/style/xsl/html/simple-page2html.xsl">
            <map:parameter name="contextPath" value="{request:contextPath}"/>
            <map:parameter name="servletPath" value="{request:servletPath}"/>
            <map:parameter name="sitemapURI" value="{request:sitemapURI}"/>
            <map:parameter name="file" value="woody/employee.xml"/>
            <map:parameter name="remove" value="{0}"/>
        </map:transform>
        <map:serialize/>
    </map:match>

    <map:match pattern="jdo/woody/employee-form-success">
        <map:generate type="serverpages" src="woody/success.xsp"/>
        <map:transform src="context://samples/common/style/xsl/html/simple-page2html.xsl">
            <map:parameter name="contextPath" value="{request:contextPath}"/>
            <map:parameter name="servletPath" value="{request:servletPath}"/>
            <map:parameter name="sitemapURI" value="{request:sitemapURI}"/>
            <map:parameter name="file" value="woody/success.xsp"/>
            <map:parameter name="remove" value="{0}"/>
        </map:transform>
        <map:serialize/>
    </map:match>

     <!-- Manages continuations -->
     <map:match pattern="jdo/woody/*.continue">
       <map:call continuation="{1}"/>
     </map:match>

     <!-- odmg samples -->    
     <map:match pattern="odmg/xspdemo">
        <map:generate src="odmg/xsp/demo1.xsp" type="serverpages"/>
        <map:transform src="context://samples/stylesheets/dynamic-page2html.xsl">
            <map:parameter name="servletPath" value="{request:servletPath}"/>
            <map:parameter name="sitemapURI" value="{request:sitemapURI}"/>
            <map:parameter name="contextPath" value="{request:contextPath}"/>
            <map:parameter name="file" value="odmg/xsp/xspdemo.xsp"/>
            <map:parameter name="remove" value="{0}"/>
        </map:transform>
        <map:serialize/>
     </map:match>

   </map:pipeline>
 </map:pipelines>

</map:sitemap>
