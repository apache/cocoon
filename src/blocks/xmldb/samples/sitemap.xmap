<?xml version="1.0" encoding="UTF-8"?>
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

<!-- ========================= Components ================================ -->

 <map:components>
  <map:generators default="file">
    <!-- =================== XML:DB Generators ========================= -->
    <!-- BEWARE: these are unmaintained XML:DB generators, going to be   -->
    <!-- removed soon.                                                   -->
    <!-- You might want  to use the XML:DB pseudo protocol instead.      -->
    <map:generator name="xmldb" src="org.apache.cocoon.generation.XMLDBGenerator" label="content">
      <driver>org.apache.xindice.client.xmldb.DatabaseImpl</driver>
      <base>xmldb:xindice-embed:///db/</base>
    </map:generator>
    <map:generator name="xmldbcollection" src="org.apache.cocoon.generation.XMLDBCollectionGenerator" label="content">
      <driver>org.apache.xindice.client.xmldb.DatabaseImpl</driver>
      <base>xmldb:xindice-embed:///db/</base>
    </map:generator>
  </map:generators>

  <map:transformers default="xslt"/>
  <map:readers default="resource"/>
  <map:serializers default="html"/>
  <map:matchers default="wildcard"/>
  <map:selectors default="browser"/>
 </map:components>

<!-- =========================== Views =================================== -->

 <map:views>
  <map:view name="content" from-label="content">
   <map:serialize type="xml"/>
  </map:view>

  <map:view from-label="content" name="pretty-content">
    <map:transform src="context://stylesheets/system/xml2html.xslt"/>
    <map:serialize type="html"/>
  </map:view>
  
  <map:view name="links" from-position="last">
   <map:serialize type="links"/>
  </map:view>

 </map:views>

<!-- =========================== Pipelines ================================= -->

 <map:pipelines>

  <map:pipeline>
    <!-- =================== XML:DB Generators ========================= -->
    <!-- BEWARE: the following examples use the unmaintained XML:DB      -->
    <!-- generators, going to be deprecated soon.                        -->
    <!-- You might want  to use the XML:DB pseudo protocol instead.      -->
    <map:match pattern="xmldb-generator/db/**/">
      <map:generate type="xmldbcollection" src="/{1}"/>
      <map:serialize type="xml"/>
    </map:match>

    <map:match pattern="xmldb-generator/db/**">
      <map:generate type="xmldb" src="/{1}"/>
      <map:serialize type="xml"/>
    </map:match>
  </map:pipeline>

  <map:pipeline>
    <!-- ======================= XML:DB ============================== -->
    <map:match pattern="**">
      <map:match type="request-parameter" pattern="xpath">
        <map:generate src="xmldb:xindice-embed:///db/{../1}#{1}"/>
        <map:serialize type="xml"/>
      </map:match>

      <map:generate src="xmldb:xindice-embed:///db/{1}"/>
      <map:serialize type="xml"/>
    </map:match>
  </map:pipeline>

 </map:pipelines>

</map:sitemap>
