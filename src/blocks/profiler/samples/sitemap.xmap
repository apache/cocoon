<?xml version="1.0"?>

<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

 <map:components>
  <map:generators   default="file"/>
  <map:transformers default="xslt"/>
  <map:readers      default="resource"/>
  <map:serializers  default="html"/>
  <map:matchers     default="wildcard"/>
  <map:selectors    default="browser"/>
  <map:actions/>
  <map:pipes        default="caching"/>
 </map:components>

<!-- =========================== Views =================================== -->

 <map:views>
  <map:view name="content" from-label="content">
   <map:serialize type="xml"/>
  </map:view>

  <map:view name="pretty-content" from-label="data">
    <map:transform src="context://stylesheets/system/xml2html.xsl"/>
    <map:serialize type="html"/>
  </map:view>

  <map:view name="links" from-position="last">
   <map:serialize type="links"/>
  </map:view>
  
 </map:views>

<!-- =========================== Pipelines ================================= -->

 <map:pipelines>

<!-- =========================== Cacheable ================================= -->

  <map:pipeline type="profile-caching">

   <map:match pattern="caching-testsite.html">
    <map:generate src="test.xml"/>
    <map:transform src="test2page.xsl"/>
    <map:transform src="page2html.xsl"/>
    <map:serialize type="html"/>
   </map:match>

  </map:pipeline>

<!-- =========================== Noncacheable ================================= -->

  <map:pipeline type="profile-noncaching">

   <map:match pattern="noncaching-testsite.html">
    <map:generate src="test.xml"/>
    <map:transform src="test2page.xsl"/>
    <map:transform src="page2html.xsl"/>
    <map:serialize type="html"/>
   </map:match>

  </map:pipeline>

<!-- =========================== Profiler ================================= -->

  <map:pipeline type="caching">

   <map:match pattern="">
    <map:redirect-to uri="welcome"/>
   </map:match>

   <map:match pattern="welcome">
    <map:generate src="samples.xml"/>
    <map:transform src="context://samples/common/style/xsl/html/simple-samples2html.xsl">
       <map:parameter name="contextPath" value="{request:contextPath}"/>
    </map:transform>
    <map:serialize/>
   </map:match>
  
   <map:match pattern="profile.html">
    <map:generate type="profiler"/>
    <map:transform src="profile2page.xsl">
     <map:parameter name="use-request-parameters" value="true"/>
    </map:transform>
    <map:transform src="page2html.xsl"/>
    <map:serialize type="html"/>
   </map:match>

   <map:match pattern="profile2.html">
    <map:generate type="profiler"/>
    <map:transform src="profile2html.xsl">
     <map:parameter name="use-request-parameters" value="true"/>
    </map:transform>
    <map:serialize type="html"/>
   </map:match>

   <map:match pattern="profile.xml">
    <map:generate type="profiler"/>
    <map:serialize type="xml"/>
   </map:match>

   <map:match pattern="*.css">
    <map:read src="{1}.css" mime-type="text/css"/>
   </map:match>

   <map:match pattern="*.js">
    <map:read src="{1}.js" mime-type="text/javascript"/>
   </map:match>
   
  </map:pipeline>
 
 </map:pipelines>

</map:sitemap>
